{
	"info": {
		"_postman_id": "wallet-microservice-api",
		"name": "Wallet Microservice API",
		"description": "Complete API collection for the Wallet Microservice. Includes wallet management, deposits, withdrawals, transfers, and transaction history.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Wallets",
			"item": [
				{
					"name": "Create Wallet",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('wallet_id', response.data.id);",
									"    console.log('Wallet ID saved: ' + response.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"owner_name\": \"John Doe\",\n    \"currency\": \"USD\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets"
							]
						},
						"description": "Create a new wallet with owner name and currency (ISO 4217 code)."
					},
					"response": []
				},
				{
					"name": "Create Wallet (EUR)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('wallet_id_2', response.data.id);",
									"    console.log('Second Wallet ID saved: ' + response.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"owner_name\": \"Jane Smith\",\n    \"currency\": \"EUR\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets"
							]
						},
						"description": "Create a second wallet for testing transfers."
					},
					"response": []
				},
				{
					"name": "Get Wallet Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}"
							]
						},
						"description": "Retrieve details of a specific wallet by ID."
					},
					"response": []
				},
				{
					"name": "List All Wallets",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets"
							]
						},
						"description": "List all wallets without filters."
					},
					"response": []
				},
				{
					"name": "List Wallets (Filter by Owner)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets?owner=John",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets"
							],
							"query": [
								{
									"key": "owner",
									"value": "John"
								}
							]
						},
						"description": "Filter wallets by owner name (partial match)."
					},
					"response": []
				},
				{
					"name": "List Wallets (Filter by Currency)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets?currency=USD",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets"
							],
							"query": [
								{
									"key": "currency",
									"value": "USD"
								}
							]
						},
						"description": "Filter wallets by currency code."
					},
					"response": []
				},
				{
					"name": "Get Wallet Balance",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/balance",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"balance"
							]
						},
						"description": "Get the current balance of a wallet."
					},
					"response": []
				}
			],
			"description": "Endpoints for managing wallets (create, list, get details)."
		},
		{
			"name": "Transactions",
			"item": [
				{
					"name": "Deposit Funds",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{$guid}}",
								"description": "Unique key to prevent duplicate deposits"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 10000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"deposit"
							]
						},
						"description": "Deposit funds into a wallet. Amount is in minor units (e.g., 10000 = $100.00)."
					},
					"response": []
				},
				{
					"name": "Deposit Funds (Idempotency Test)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "test-deposit-123",
								"description": "Same key for testing idempotency"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 5000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"deposit"
							]
						},
						"description": "Test idempotency by using the same Idempotency-Key twice. Should return the original transaction."
					},
					"response": []
				},
				{
					"name": "Withdraw Funds",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{$guid}}",
								"description": "Unique key to prevent duplicate withdrawals"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 2000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/withdraw",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"withdraw"
							]
						},
						"description": "Withdraw funds from a wallet. Amount is in minor units (e.g., 2000 = $20.00)."
					},
					"response": []
				},
				{
					"name": "Withdraw Funds (Insufficient Balance)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 999999999\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/withdraw",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"withdraw"
							]
						},
						"description": "Test insufficient balance error by trying to withdraw more than available."
					},
					"response": []
				},
				{
					"name": "Get Transaction History",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/transactions",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"transactions"
							]
						},
						"description": "Get paginated transaction history for a wallet."
					},
					"response": []
				},
				{
					"name": "Get Transaction History (Filtered)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/transactions?type=deposit&per_page=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"transactions"
							],
							"query": [
								{
									"key": "type",
									"value": "deposit",
									"description": "Filter by type: deposit, withdrawal, transfer_debit, transfer_credit"
								},
								{
									"key": "per_page",
									"value": "10",
									"description": "Results per page"
								}
							]
						},
						"description": "Get transaction history filtered by type with pagination."
					},
					"response": []
				}
			],
			"description": "Endpoints for deposits, withdrawals, and transaction history."
		},
		{
			"name": "Transfers",
			"item": [
				{
					"name": "Transfer Funds (Same Currency)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{$guid}}",
								"description": "Unique key to prevent duplicate transfers"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"source_wallet_id\": {{wallet_id}},\n    \"target_wallet_id\": {{wallet_id_2}},\n    \"amount\": 3000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/transfers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"transfers"
							]
						},
						"description": "Transfer funds between two wallets with the same currency. Creates debit and credit transactions."
					},
					"response": []
				},
				{
					"name": "Transfer Funds (Idempotency Test)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "test-transfer-456",
								"description": "Same key for testing idempotency"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"source_wallet_id\": {{wallet_id}},\n    \"target_wallet_id\": {{wallet_id_2}},\n    \"amount\": 1000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/transfers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"transfers"
							]
						},
						"description": "Test transfer idempotency by using the same Idempotency-Key twice."
					},
					"response": []
				},
				{
					"name": "Transfer Funds (Currency Mismatch Error)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"source_wallet_id\": 1,\n    \"target_wallet_id\": 2,\n    \"amount\": 1000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/transfers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"transfers"
							]
						},
						"description": "Test currency mismatch error by transferring between USD and EUR wallets (if they have different currencies)."
					},
					"response": []
				},
				{
					"name": "Transfer Funds (Self Transfer Error)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"source_wallet_id\": {{wallet_id}},\n    \"target_wallet_id\": {{wallet_id}},\n    \"amount\": 1000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/transfers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"transfers"
							]
						},
						"description": "Test self-transfer error by using the same wallet as source and target."
					},
					"response": []
				}
			],
			"description": "Endpoints for transferring funds between wallets."
		},
		{
			"name": "Error Scenarios",
			"item": [
				{
					"name": "Invalid Amount (Zero)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 0\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"deposit"
							]
						},
						"description": "Test validation error for zero amount."
					},
					"response": []
				},
				{
					"name": "Invalid Amount (Negative)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": -1000\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets/{{wallet_id}}/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"{{wallet_id}}",
								"deposit"
							]
						},
						"description": "Test validation error for negative amount."
					},
					"response": []
				},
				{
					"name": "Invalid Currency Code",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"owner_name\": \"Test User\",\n    \"currency\": \"INVALID\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/wallets",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets"
							]
						},
						"description": "Test validation error for invalid currency code (must be 3 characters)."
					},
					"response": []
				},
				{
					"name": "Wallet Not Found",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/wallets/999999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"wallets",
								"999999"
							]
						},
						"description": "Test 404 error for non-existent wallet."
					},
					"response": []
				}
			],
			"description": "Test various error scenarios and validation."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "wallet_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "wallet_id_2",
			"value": "2",
			"type": "string"
		}
	]
}
